---
title: mysql学习笔记（三）
date: 2017-02-14 15:48:45
tags:
    - mysql
    - 索引
categories: mysql
---
# 创建高性能索引
索引是存储引擎中快速找到记录的一种数据结构。
在数据量比较小的表里，索引作用并不明显，但是在数据量较大时，索引对性能的提升非常重要。
## 索引类别
### B-Tree索引
当人们讨论索引时，如果没有明确指定类型，多半说的时B-Tree索引,B-Tree索引使用B-Tree的数据结构存储索引。
B-Tree适用于全值键、键值范围、键前缀查找（即索引定义的最左边列）。
### 哈希索引
基于哈希表实现，只有精确匹配所有所有列的查询才有效。
哈希表限制：
+ 哈表索引只保存哈希值和行指针，不存储行字段，所以不能使用索引中的值避免行读取。
+ 哈希索引并不是按索引值顺序存储的，所以也无法用于排序。
+ 哈希索引也不支持部分索引列匹配查找。
+ 哈希索引只支持等值比较

## 高性能索引策略

### 独立的列
如果查询的列不是独立的则mysql无法使用索引。'独立的列'是值索引列不能是表达式的一部分或则函数的参数。
下面例子无法使用id索引：
```
mysql> select * from user where id+1=5;
```
该例子是要查id=6的，但是因为写的格式问题，mysql无法理解。就无法使用索引。
### 前缀索引和索引选择性
有时候需要对长字符串进行索引，这会让索引变得很慢。前面有提到使用类hash的方式实现。也可以使用前缀索引的方式。
前缀索引就是取字符串的前n位进行索引，根据前n位进行索引再去检索匹配到的结果集。
索引的选择性：选择不同长度的前缀作为索引再不同的引用下不一样。根据具体的情况去选择最合适的前缀索引。

### 多列索引
多列索引并不是值未多个列单独建立索引，而是多列建立联合索引。
例如建立id和性别的多列索引：
```
mysql> alter table user add index ix_id_sex(id,sex);
```
### 选择合适的索引列顺序
在添加多列索引的时候一定要选择合适的索引列顺序。不同的顺序在不同场景下可能差别会很大。